<!-- Card -->
<div
  (click)="onCardClick()"
  class="relative bg-white shadow-lg rounded-lg p-5 hover:shadow-xl transition-shadow flex flex-col border-t-4"
  [ngClass]="{
    'border-blue-500': task.status === TaskStatus.TO_DO,
    'border-amber-500': task.status === TaskStatus.IN_PROGRESS,
    'border-green-500': task.status === TaskStatus.COMPLETED
  }"
>

  <!-- Header -->
  <div class="flex items-start justify-between gap-4">

    <!-- Left: Title & Description -->
    <div class="min-w-0">
      <h3 class="font-semibold text-lg text-gray-900 leading-snug truncate">
        {{ task.title | uppercase }}
      </h3>

      <p class="mt-1 text-sm text-gray-600 break-words">
        {{ task.description }}
      </p>
    </div>

    <!-- Right: Status Badge -->
    <span
      class="text-xs font-medium px-2.5 py-1 rounded-full border shrink-0"
      [ngClass]="{
        'bg-blue-50 text-blue-700 border-blue-200': task.status === TaskStatus.TO_DO,
        'bg-yellow-50 text-yellow-700 border-yellow-200': task.status === TaskStatus.IN_PROGRESS,
        'bg-green-50 text-green-700 border-green-200': task.status === TaskStatus.COMPLETED
      }"
    >
      {{ task.status | uppercase }}
    </span>

  </div>

  <!-- Actions -->
  <div class="mt-4 flex items-center gap-2">

    <!-- Edit -->
    <button
      class="inline-flex items-center gap-2 text-sm bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md cursor-pointer"
      (click)="$event.stopPropagation(); onEditClick()"
    >
      Edit
    </button>

    <!-- Change Status -->
    <button
      class="inline-flex items-center gap-2 text-sm bg-amber-100 text-amber-700 hover:bg-amber-200 px-3 py-1.5 rounded-md cursor-pointer"
      (click)="$event.stopPropagation(); toggleDropdown()"
    >
      Change Status
    </button>

    <!-- Dropdown -->
    @if (showDropdown) {
      <div
        class="absolute z-10 mt-2 w-40 bg-white border border-gray-200 rounded-md shadow-lg p-1"
        (click)="$event.stopPropagation()"
      >
        @for (status of statuses; track status) {
          <button
            (click)="changeStatus(status)"
            class="w-full text-left px-3 py-2 rounded text-sm transition-colors"
            [ngClass]="getStatusClasses(status)"
          >
            {{ status }}
          </button>
        }
      </div>
    }

    <!-- Delete -->
    <button
      class="inline-flex items-center gap-2 text-sm bg-red-100 text-red-700 hover:bg-red-200 px-3 py-1.5 rounded-md cursor-pointer"
      (click)="$event.stopPropagation(); onDelete()"
    >
      Delete
    </button>

  </div>

  <!-- Dates -->
  <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
    <div class="flex items-center gap-2">
      <span class="text-gray-500 shrink-0">Due:</span>
      <span class="font-medium text-gray-800 truncate">
        {{ task.dueDate }}
      </span>
    </div>
  </div>

</div>
<!-- /Card -->